<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      body { background: black; }
      canvas {
        margin: 1em auto;
        display: block;
        background: #815ba4;
      }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
      }
    </style>
    <title></title>

  </head>
  <body>
    <canvas></canvas>
    <script>
      const canvas = document.querySelector('canvas')
      const ctx = canvas.getContext('2d')

      // Set display size (css pixels).
      const size = 256
      canvas.style.width = size + 'px'
      canvas.style.height = size + 'px'

      // Set actual size in memory (scaled to account for extra pixel density).
      // <--- Change to 1 on retina screens to see blurry canvas.
      const scale = window.devicePixelRatio
      canvas.width = size * scale
      canvas.height = size * scale

      // Normalize coordinate system to use css pixels.
      ctx.scale(scale, scale)

      const arrowUp = () => keys.has('ArrowUp')
      const arrowRight = () => keys.has('ArrowRight')
      const arrowDown = () => keys.has('ArrowDown')
      const arrowLeft = () => keys.has('ArrowLeft')

      let keys = new Set()

      document.addEventListener('keydown', function (e) {
        const keyName = event.key
        keys.add(keyName)
        console.log(keys)
      }, )

      document.addEventListener('keyup', function (e) {
        const keyName = event.key
        keys.delete(keyName)
        console.log(keys)
      }, )

      const clear = function () {
        ctx.clearRect(0, 0, size, size)
      }

      let update = function () {}
      let draw = function () {}

      setInterval(function () {
        update && update()
        clear()
        draw && draw()
      }, 1000/30)

      window.gametron = {
        callCode: function(javascriptString) {
          try {
            const func = new Function(javascriptString)
            func()
          }
          catch(e) {}
        }
      }
    </script>  </body>
</html>
